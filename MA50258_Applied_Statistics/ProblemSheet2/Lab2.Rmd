---
title: 'MA50258: Applied Statistics Lab 2'
author: "Your name here"
output:
  html_document:
    number_sections: no
    toc: yes
    toc_float: yes
    code_download: yes
  pdf_document:
    keep_tex: yes
    number_sections: yes
always_allow_html: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, highlight = TRUE)
```

```{r klippy, echo=FALSE, include=TRUE}
klippy::klippy()
```


# Instructions

 * As indicated in each part, complete your answers, in the 'Lab2.Rmd' file which can be downloaded by clicking in the **Code button** at the top right of this page. If the **Code button** does not work you can download the 'Lab2.Rmd' file from the Moodle page. You should open this file in RStudio.
 
*  After you complete your answers you should convert this file into an HTML file  by following the instructions in the <a href="#knit-to-html">Knit to html</a> section at the end of this file!

* You should submit both your completed R Markdown file (which should be named 'Lab2.Rmd') and the created HTML file (which should be named 'Lab2.html') to the  <a href="https://moodle.bath.ac.uk/mod/assign/view.php?id=1115465">submission point in Moodle</a>

* This is lab is a **formative assessment** and  you will receive feedback to your submitted work on an informal basis.


# Introduction


The goal of this lab is to consolidate your knowledge on the basics of performing simple regression model (linear models and generalised linear models) in R. You are encouraged to use  pipes (` %>% `) as well as appropriate indentation in your code answers. Overall, `log` refers to natural logarithm.




# Packages


```{r message=FALSE}
library(tidyverse) 
library(knitr) # general purpose literate programming tools
library(klippy) # to copy chunks of code to clipboard
library(patchwork) # to arrange ggplots in flexible layouts
library(broom) # to tody model outputs
library(kableExtra) # to convert data frames to HTML tables
```



# Sustainable development goals (SDG) data


The data comes from UNESCO's [Sustainable Development Goals](https://en.unesco.org/sustainabledevelopmentgoals). The data is of free access via UNESCO [Institute of Statistics ](http://data.uis.unesco.org). The dataset contains:


* Information about 89 countries

* 9 variables of education and socio-demographic

* Yearly information from 2013 to 2017

## Variable dictionary

The description of the variables in the SDG data set is below.

* `country`: Name of the country (character)

* `year`: year of observation

* `continent`: name of the continent (character)

* `region`: region of the continent (character)

* `years_education`: mean number of years in education for population over 25 years of age 

* `gdp`: GDP per capita (in US dollars)

* `life_expectancy` = Life expectancy at birth in years

* `infant_mortality_rate`= infant mortality rate (per 1,000 live births)

* `income_class` = World Bank income classification (character): 
L =low, LM =low-middle, UM = middle-upper and H= upper


## Load the data

The data can be loaded into `R` using the following command:

```{r,message=FALSE}
# sdg <- read_csv("https://people.bath.ac.uk/kai21/MA50258/data/sdg.csv")
sdg <- read_csv('~/University of Bath - Semester 2 Coursework/MA50258_Applied_Statistics/ProblemSheet2/sdg.csv')
```


Remind yourself this data by having a quick glimpse, e.g.:

```{r}
glimpse(sdg)
```

Each row in `sdg` refers to an specific country in a specific year.

## Regression models

Consider the linear model
$$E[Y|x]=\alpha_0 +\alpha_1 x$$
The interpretation of the parameter $\alpha_0$ is as follows: if $x=0$ then $\alpha_0=E[Y|x=0]$ so it is interpreted as the  mean value of the random variable $Y$ conditional on $x=0$ (remember those slices seen in the lectures). This might or might not make sense in the context of the data. 
The interpretation of $\alpha_1$ is as follows:

\begin{align*}
E[Y|x+1] &= \alpha_0 +\alpha_1 (x+1) \\
E[Y|x] &= \alpha_0 +\alpha_1 x 
\end{align*}

and this  implies

$$E[Y|x+1]-E[Y|x]=\alpha_1$$
so that $\alpha_1$ can be interpreted as the absolute change in (conditional) means of the response $Y$ for a unit change in the explanatory variable $x$.

Now consider the transformed linear model

$$E[\log(Y)|x]=\beta_0 +\beta_1 x$$
Exponentiating on both sides of the above equation, we obtain

$$e^{E[\log(Y)|x]}=e^{\beta_0} e^{\beta_1 x}$$
The left hand side is clearly a (conditional) geometric average (just think the geometric average of two numbers $a$ and $b$ can be written as $(ab)^{1/2}=e^{0.5\log a +0.5 \log b}$). We then have

$$\frac{e^{E[\log(Y)|x+1]}}{e^{E[\log(Y)|x]}}=e^{\beta_1}$$

so the interpretation  of $\exp(\beta_1)$ is that of the relative increase in the  geometric average of $Y$ for unit increase in $x$.
The interpretation of the parameter $\beta_0$ is  $\beta_0=E[\log(Y)|x=0]$ so it is interpreted as the  mean value of the log of the random variable $Y$ conditional on $x=0$. This might or might not make sense in the context of the data. 

Finally, consider the following generalised linear model:

$$g(E[Y|x])=\gamma_0+\gamma_1\,x$$
where $g$ is a function called the _link_ function. The interpretation of both $\gamma_0$ and $\gamma_1$ depend on any specific link $g$. Abstractly, we have that
$$\gamma_1=g(E[Y|x+1])-g(E[Y|x])$$
so $\gamma_1$ is the absolute change in transformed conditional response means  for a unit change in the explanatory variable $x$. 

For example, if $\mu>0$ and $g(\mu)=\log \mu$ (called the log link) then $\gamma_1= \log(E[Y|x+1])-\log(E[Y|x])$ which implies
$$e^{\gamma_1}=\frac{E[Y|x+1]}{E[Y|x]}$$
so that $e^{\gamma_1}$ is interpreted as the relative change (increase or decrease) in conditional response means for a unit change in the explanatory variable $x$.

As another example consider $\mu \in (0,1)$ with $g(\mu)=\mbox{logit}(\mu):=\log(\mu/(1-\mu))$ (the logit link) then 
$$\gamma_1=\mbox{logit}(E[Y|x+1])-\mbox{logit}(E[Y|x])=\log\left(\frac{\mbox{odds}(Y|x+1)}{\mbox{odds}(Y|x)}\right)$$
which implies
$$e^{\gamma_1}=\frac{\mbox{odds}(Y|x+1)}{\mbox{odds}(Y|x)}$$
so that $e^{\gamma_1}$ is interpreted as the relative change (increase or decrease) in conditional odds for a unit change in the explanatory variable $x$.

In general, the quantity 

$$\frac{\mbox{odds}(Y|x+1)}{\mbox{odds}(Y|x)}$$

is usually known as the **odds ratio**. This would be the case if $Y \in \{0,1\}$ is a binary random variable so that $E[Y|x] \in (0,1)$ for any explanatory variable $x$. This defines a simple logistic regression model where $e^{\gamma_1}$ is the conditional response odds ratio.


You should only consider data from 2017 for all the questions in this lab!

```{r}
sdg <- filter(sdg, year==2017)
```

### Task 1

Use `ggplot2` to do a scatter plot of gdp per capita (horizontal) against life expectancy (vertical). 
Use `+ geom_smooth()` to add to this scatter plot, the corresponding fitted line by least squares. Use the option `se = TRUE` to include a 95\% confidence band (see `?geom_smooth`). Visually assess the goodness of the fit of the least squares line.

In the code chunk below, write `R` code to answer this question. The knitted HTML file should display both code (using RMarkdown option `echo=TRUE`) and the plot (`eval=TRUE`) requested.

```{r Task_1, echo=TRUE, eval=TRUE}
# Your code here
ggplot(data = sdg, aes(gdp, life_expectancy)) +
  geom_smooth(method = "lm", se = TRUE, level = 0.95, linewidth = 0.5) +
  geom_point(alpha = 0.5) +
  xlab("GDP per capita (US dollars)") +
  ylab("Life expectancy (years)") +
  ggtitle("Life expectancy against GDP per capita")
```


### Task 2

Now use `+ scale_x_continuous(trans = "log")` to do a scatter plot of the natural logarithm of gdp per capita (horizontal) against life expectancy (vertical). Use `+xlab()` to indicate in the horizontal axis label that the logarithm transformation has been used. Use `geom_smooth` to add to this scatter plot,  the corresponding fitted line by least squares. Use the option `se = TRUE` to include a 95\% confidence band. Note that the scale transformation on the horizontal axis implies that we are plotting the pairs $(\log(\mbox{gdp}),\mbox{life_expectancy})$ instead of $(\mbox{gdp},\mbox{life_expectancy})$ and this trasnformation occurs before the fitting by least squares occurs. What can you conclude about the relationship between the  log of gdp per capita and the average life expectancy?


In the code chunk below, write `R` code to answer this question. The knitted HTML files should display both code and the plot requested.

```{r Task_2,echo=TRUE, eval=TRUE}
# Your code here
ggplot(data = sdg, aes(x = log(gdp), y = life_expectancy)) +
  geom_point(alpha = 0.5) +
  geom_smooth(method = "lm", se = TRUE, level = 0.95) +
  xlab("Log of GDP per capita (US dollars)") +
  ylab("Life expectancy (years)") +
  ggtitle("Life expectancy against Log of GDP per capita") +
  scale_x_continuous(trans = "log", labels = scales::label_dollar())
```

#### My answer for Task 2

The scatter plot of the natural logarithm of gdp per capita (horizontal) against life expectancy (vertical) shows a clear linear relationship between the two variables. The fitted line by least squares shows a positive relationship between the two variables, indicating that as the natural logarithm of gdp per capita increases, life expectancy also increases. The 95% confidence band is quite narrow, indicating that the fitted line is a good fit to the data.

### Task 3

Use `lm` to fit the linear model 
$$E[\mbox{life_expectancy}|\mbox{gdp}]=\alpha_0 + \alpha_1 \,\log(\mbox{gdp})$$ 

This is the same linear model visually fitted in Task 2.
Use commands from  libraries `broom` and `kableExtra`  to display the estimated values of $\alpha_0$ and $\alpha_1$ as well as their standard errors. What is the interpretation of $\alpha_1$ in the context of this dataset?

In the code chunk below, write `R` code to answer this question. The knitted HTML files should display both code and the plot requested.

```{r Task_3,echo=TRUE, eval=TRUE}
# Your code here
task_3 <- lm(life_expectancy ~ log(gdp), data = sdg) %>% broom::tidy()
task_3 %>% select(term, estimate) %>%
  kable(caption = "Estimated coefficients for the linear model of life expectancy against log of gdp per capita", digits = 2) %>%
  kable_styling(bootstrap_options = "striped", full_width = F)
```

#### My answer for Task 3

The estimated $\alpha_1$ coefficient for the log of gdp per capital is $3.82. This means that for a $1.00 increase in the log of gdp per capita, life expectancy is expected to increase by 3.82 years.

### Task 4

The plot in Task 2 has the units of $\log(\mbox{gdp})$ in the horizontal axis. To transform both the scatter plot as well as the fitted line, back to the original horizontal scale  in units of gdp, you can simply add the  layer `+ coord_trans(x = scales::exp_trans(exp(1)))` to the `ggplot` command. Visually assess this non-linear fit to the data points.


In the code chunk below, write `R` code to answer this question. The knitted HTML files should display both code and the plot requested.

```{r Task_4,echo=TRUE, eval=TRUE}
# Your code here
ggplot(data = sdg, aes(x = log(gdp), y = life_expectancy)) +
  geom_point(alpha = 0.5) +
  geom_smooth(method = "lm", se = TRUE, level = 0.95) +
  xlab("Log of GDP per capita (US dollars)") +
  ylab("Life expectancy (years)") +
  ggtitle("Life expectancy against Log of GDP per capita") +
  scale_x_continuous(trans = "log", labels = scales::label_dollar()) +
  coord_trans(x = scales::exp_trans(exp(1)))
```

#### My answer for Task 4

The scatter plot of the natural logarithm of gdp per capita (horizontal) against life expectancy (vertical) shows a clear linear relationship between the two variables. The fitted line by least squares shows a positive relationship between the two variables, indicating that as the natural logarithm of gdp per capita increases, life expectancy also increases. The 95% confidence band is quite narrow, indicating that the fitted line is a good fit to the data.

### Task 5

Now do a scatter plot of years in education (horizontal) against infant mortality rate (vertical). 
Use `+ geom_smooth()` to add to this scatter plot, the corresponding fitted line by least squares. Use the option `se = TRUE` to include 95\% confidence band. Visually assess the goodness of the fit of the least squares line.

In the code chunk below, write `R` code to answer this question. The knitted HTML file should display both code (using RMarkdown option `echo=TRUE`) and the plot (`eval=TRUE`) requested.

```{r Task_5, echo=TRUE, eval=TRUE}
# Your code here
ggplot(data = sdg, aes(years_education, infant_mortality_rate)) +
  geom_smooth(method = "lm", se = TRUE, level = 0.95, linewidth = 0.5) +
  geom_point(alpha = 0.5) +
  xlab("Years in education") +
  ylab("Infant mortality rate (per 1,000 live births)") +
  ggtitle("Infant mortality rate against years in education")
```

#### My answer for Task 5

The scatter plot of years in education (horizontal) against infant mortality rate (vertical) shows a clear linear relationship between the two variables. The fitted line by least squares shows a negative relationship between the two variables, indicating that as the years in education increases, infant mortality rate decreases. The 95% confidence band is quite narrow, indicating that the fitted line is a good fit to the data.

### Task 6

Now add `+ scale_y_continuous(trans = "log")` to do a scatter plot of the years in education variable (horizontal) against the natural logarithm of infant mortality raye (vertical). Use `+ylab()` to indicate in the vertical axis label that the logarithm transformation has been used. Use `geom_smooth` to add to this scatter plot,  the corresponding fitted line by least squares. Use the option `se = TRUE` to include a 95\% confidence band. Note this is a transformed linear model and  that the scale transformation on the vertical axis implies that we are plotting the pairs $(\mbox{years_education},\log(\mbox{infant_mortality_rate}))$ instead of $(\mbox{years_education},\mbox{infant_mortality_rate})$ and this trasnformation occurs before the fitting by least squares occurs. 

What can you conclude about the relationship between the years in education variable and the average natural logarithm of infant mortality rate.


In the code chunk below, write `R` code to answer this question. The knitted HTML file should display both code (using RMarkdown option `echo=TRUE`) and the plot (`eval=TRUE`) requested.

```{r Task_6, echo=TRUE, eval=TRUE}
# Your code here
ggplot(data = sdg, aes(x = years_education, y = log(infant_mortality_rate))) +
  geom_point(alpha = 0.5) +
  geom_smooth(method = "lm", se = TRUE, level = 0.95) +
  xlab("Years in education") +
  ylab("Log of Infant mortality rate (per 1,000 live births)") +
  ggtitle("Log of Infant mortality rate against years in education") +
  scale_y_continuous(trans = "log")
```

#### My answer for Task 6

The fitting becomes a bit more precise for data points with < 5 years in education. Previously before the log transformation, the linear model line could not properly fit data points with < 5 years in education.

The scatter plot of the years in education variable (horizontal) against the natural logarithm of infant mortality rate (vertical) shows a clear linear relationship between the two variables. The fitted line by least squares shows a negative relationship between the two variables, indicating that as the years in education increases, the natural logarithm of infant mortality rate decreases. The 95% confidence band is quite narrow, indicating that the fitted line is a good fit to the data.

### Task 7


Now transform both the scatter plot as well as the fitted line, back to the original horizontal scale  of units of infant mortality rate. Visually assess this non-linear fit to the data points. 

In the code chunk below, write `R` code to answer this question. The knitted HTML file should display both code (using RMarkdown option `echo=TRUE`) and the plot (`eval=TRUE`) requested.

```{r Task_7, echo=TRUE, eval=TRUE}
# Your code here
ggplot(data = sdg, aes(x = years_education, y = log(infant_mortality_rate))) +
  geom_point(alpha = 0.5) +
  geom_smooth(method = "lm", se = TRUE, level = 0.95) +
  xlab("Years in education") +
  ylab("Log of Infant mortality rate (per 1,000 live births)") +
  ggtitle("Log of Infant mortality rate against years in education") +
  scale_y_continuous(trans = "log") +
  coord_trans(y = scales::exp_trans(exp(1)))
```

#### My answer for Task 7

The log-transformed and re-transformed has shown us that for data points with < 5 years in education, the fitting has improved but not significantly so, suggesting that a straight line is a much better fit here than a curved line for log-transformed and re-transformed data. 
The scatter plot of the years in education variable (horizontal) against the natural logarithm of infant mortality rate (vertical) shows a clear linear relationship between the two variables. The fitted line by least squares shows a negative relationship between the two variables, indicating that as the years in education increases, the natural logarithm of infant mortality rate decreases. The 95% confidence band is quite narrow, indicating that the fitted line is a good fit to the data.

### Task 8
Use `lm` to fit the transformed linear model 
$$E[\log(\mbox{infant_mortility_rate})|\mbox{years_education}]=\beta_0 + \beta_1 \,\mbox{years_education}$$ 

This is the same transformed linear model visually fitted in Task 6.
Display the estimated values of $\beta_0$ and $\beta_1$ as well as their standard errors. What is the interpretation of $\beta_0$ and $\beta_1$ in the context of this dataset?


In the code chunk below, write `R` code to answer this question. The knitted HTML file should display both code (using RMarkdown option `echo=TRUE`) and the plot (`eval=TRUE`) requested.

```{r Task_8, echo=TRUE, eval=TRUE}
# Your code here
task_8 <- lm(log(infant_mortality_rate) ~ years_education, data = sdg) %>% broom::tidy()
task_8 %>% select(term, estimate) %>%
  kable(caption = "Estimated coefficients for the linear model of log of infant mortality rate against years in education", digits = 2) %>%
  kable_styling(bootstrap_options = "striped", full_width = F)
```

#### My answer for Task 8

The estimated $\beta_1$ coefficient for the years in education is $-0.27. This means that for a 1 year increase in the years in education, the natural logarithm of infant mortality rate is expected to decrease by 0.27.

### Task 9

Use `glm` to fit the following generalised linear model 

$$\log\left(E[\mbox{infant_mortility_rate}|\mbox{years_education}]\right)=\gamma_0 + \gamma_1 \,\mbox{years_education}$$ 


Display the estimated values of $\gamma_0$ and $\gamma_1$ as well as their standard errors. What is the interpretation of $\gamma_1$ in the context of this dataset?


In the code chunk below, write `R` code to answer this question. The knitted HTML file should display both code (using RMarkdown option `echo=TRUE`) and the plot (`eval=TRUE`) requested.

```{r Task_9, echo=TRUE, eval=TRUE}
# Your code here
task_9 <- glm(log(infant_mortality_rate) ~ years_education, data = sdg) %>% broom::tidy()
task_9 %>% select(term, estimate) %>%
  kable(caption = "Estimated coefficients for the generalised linear model of log of infant mortality rate against years in education", digits = 2) %>%
  kable_styling(bootstrap_options = "striped", full_width = F)
```

#### My answer for Task 9

The estimated $\gamma_1$ coefficient for the years in education is $-0.27. This means that for a 1 year increase in the years in education, the natural logarithm of infant mortality rate is expected to decrease by 0.27. Thus, the interpretation of $\gamma_1$ is the same as that of $\beta_1$ in Task 8.

### Task 10

Now use `ggplot2` to do  the scatter plot of   `years_education` (horizontal) against `infant_mortality_rate` (vertical). Include in the same plot the fitted (iteratively reweighted least squares) **curve**. This can be achieved by adding the layer

```{r,eval=FALSE}
+ geom_smooth(method = "glm", 
                       method.args = list(family = gaussian(link="log")), 
                       se = TRUE)  
```

Note there is no explicit transformation of axes needed here as the the `ggplot` layer above will take care of that for you! Compare this fit with the one obtained in Task 7 by arraging both plots side by side!



In the code chunk below, write `R` code to answer this question. The knitted HTML file should display both code (using RMarkdown option `echo=TRUE`) and the plot (`eval=TRUE`) requested.

```{r Task_10, echo=TRUE, eval=TRUE}
# Your code here
task_10_plot <- ggplot(data = sdg, aes(years_education, infant_mortality_rate)) +
  geom_point(alpha = 0.5) +
  xlab("Years in education") +
  ylab("Infant mortality rate (per 1,000 live births)") +
  ggtitle("Task 10 Plot") + 
  geom_smooth(method = "glm", 
                       method.args = list(family = gaussian(link="log")), 
                       se = TRUE, colour = "red")

task_7_plot <- ggplot(data = sdg, aes(x = years_education, y = log(infant_mortality_rate))) +
  geom_point(alpha = 0.5) +
  geom_smooth(method = "lm", se = TRUE, level = 0.95) +
  xlab("Years in education") +
  ylab("Log of Infant mortality rate (per 1,000 live births)") +
  ggtitle("Task 7 Plot") +
  scale_y_continuous(trans = "log") +
  coord_trans(y = scales::exp_trans(exp(1)))

task_10_plot + task_7_plot
```


#### My answer for Task 10

Compare to my criticism in Task 7, the fitted curve in Task 10 is a much better fit to the data points for < 5 years in education. However, the fitted curve is not a good for for data points with > 10 years in education but it isn't a problem in Task 7.

### Task 11

Using the knowledge you have acquired so far, explore the relationship between the variables
gdp per capita and infant mortality rate. Make sure you include plots, model fit summaries, verbal descriptions and possibly a few equations in the format of a mini-report.



Now you can use more than one code code chunk to answer this question

```{r Task_11a, echo=TRUE, eval=TRUE}
# Your code here
ggplot(data = sdg, aes(gdp, log(infant_mortality_rate))) +
  geom_point(alpha = 0.5) +
  geom_smooth(method = "glm",
              method.args = list(family = gaussian(link="log")),
              se = TRUE) +
  xlab("GDP per capita (US dollars)") +
  ylab("Log of Infant mortality rate (per 1,000 live births)") +
  ggtitle("Log of Infant mortality rate against GDP per capita") +
  scale_x_continuous(trans = "log", labels = scales::label_dollar())
```


#### My answer for Task 11

The scatter plot of the natural logarithm of gdp per capita (horizontal) against the natural logarithm of infant mortality rate (vertical) shows a clear linear relationship between the two variables. The fitted curve by least squares shows a negative relationship between the two variables, indicating that as the natural logarithm of gdp per capita increases, the natural logarithm of infant mortality rate decreases. The 95% confidence band is quite narrow, indicating that the fitted curve is a good fit to the data.

The gradient is steep for GDP per capita of < $1,000 but then becomes less steep for GDP per capita of > $1,000. This suggests that the relationship between GDP per capita and infant mortality rate is stronger for countries with lower GDP per capita. After a GDP per capita of $1,000, the relationship becomes weaker as the gradient becomes less steep and decrease linearly as GDP per capita increases. The rate of infant mortality starts to show a reduced rate of beneficial returns as GDP per capita approaches $60,000, suggesting that beyond this point, the rate of improvement will taper off as GDP per capita continue to increase.



### Task 12

The following command creates a categorical variable called `education` by simply categorising the numerical values of `years_education` into low, medium and high.

```{r}
sdg <- sdg %>% 
        mutate(education = cut_number(years_education,3)) %>% 
            mutate(education = fct_recode(education,
                                          .low = levels(education)[1], 
                                          .medium = levels(education)[2], 
                                          .high = levels(education)[3]))

```

Read this [article](https://forcats.tidyverse.org/reference/fct_recode.html)  for help on `fct_recode` and this  [article](https://ggplot2.tidyverse.org/reference/cut_interval.html) for help on `cut_number`.



Using the knowledge you have acquired so far, explore the relationship between the variables
life expectancy,  gdp per capita and level of education. You might consider models of the form:

$$E[\mbox{life_expectancy}|\mbox{gdp, education}]=\delta_0 +\delta_1\, \mbox{gdp} +\zeta_1\, \mbox{medium education} + \zeta_2 \,\mbox{high education}$$ 

and

$$E[\mbox{life_expectancy}|\mbox{gdp, education}]=\epsilon_0 +\epsilon_1\, \mbox{log(gdp)} +\eta_1\, \mbox{medium education} + \eta_2 \,\mbox{high education}$$



Make sure you include plots, model fit summaries, verbal descriptions and possibly a few equations in the format of a mini-report. 



Now you can use more than one code code chunk to answer this question

```{r Task_12a, echo=TRUE, eval=TRUE}
# Your code here
ggplot(data = sdg, aes(gdp, life_expectancy, color = education)) +
  geom_point(alpha = 0.5) +
  geom_smooth(method = "lm", se = F, level = 0.95, linewidth = 0.5) +
  xlab("GDP per capita (US dollars)") +
  ylab("Life expectancy (years)") +
  ggtitle("Life expectancy against GDP per capita by level of education") +
  scale_x_continuous(trans = "log", labels = scales::label_dollar())
```

```{r Task_12b, echo=TRUE, eval=TRUE}
lm(life_expectancy ~ gdp + education - 1, data = sdg) %>% broom::tidy() %>% filter(term != "gdp") %>% select(term, estimate) %>%
  kable(caption = "Estimated coefficients for the linear model of life expectancy against gdp and education", digits = 2) %>%
  kable_styling(bootstrap_options = "striped", full_width = F)
```


#### My answer for Task 12

The plot above show a clear linear relationship between life expectancy and GDP per capita by level of education. The fitted line by least squares shows a positive relationship between the two variables, indicating that as GDP per capita increases, life expectancy also increases. Between education attainment, a high level of education has a higher estimate compared to medium and low levels of education. This suggests that the relationship between life expectancy and GDP per capita is stronger for countries with higher levels of education.

# References

[Advanced  R](https://adv-r.hadley.nz/subsetting.html) by Hadley Wickham (online version)

[Scale transformations of axes 1](https://ggplot2.tidyverse.org/reference/scale_continuous.html)


[Scale transformations of axes 2](https://ggplot2.tidyverse.org/reference/coord_trans.html)


[Scale transformations of axes 3](https://ggplot2.tidyverse.org/reference/coord_trans.html)

[More on Kable](https://cran.r-project.org/web/packages/kableExtra/vignettes/awesome_table_in_html.html)